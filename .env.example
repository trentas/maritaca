# =============================================================================
# Maritaca Environment Variables
# =============================================================================
# Copy this file to .env and update with your values
#
# Required variables are uncommented with example values.
# Optional variables are commented out with their defaults.

# =============================================================================
# Database Configuration
# =============================================================================

# PostgreSQL connection string (REQUIRED)
# Format: postgresql://[user]:[password]@[host]:[port]/[database]
DATABASE_URL=postgresql://maritaca:maritaca@localhost:5432/maritaca

# =============================================================================
# Redis Configuration
# =============================================================================

# Redis connection string for BullMQ queue processing (REQUIRED)
# Format: redis://[host]:[port] or redis://[password]@[host]:[port]
REDIS_URL=redis://localhost:6379

# =============================================================================
# API Server Configuration
# =============================================================================

# API server port (default: 7377)
PORT=7377

# API server host binding (default: 0.0.0.0)
# Use 0.0.0.0 to listen on all interfaces, 127.0.0.1 for localhost only
HOST=0.0.0.0

# =============================================================================
# Logging Configuration
# =============================================================================

# Logging level: trace, debug, info, warn, error, fatal (default: info)
# Use 'debug' for development, 'info' or 'warn' for production
LOG_LEVEL=info

# =============================================================================
# Node.js Environment
# =============================================================================

# Node environment: development, production, test (default: development)
# Affects: pretty logging, error details, performance optimizations
NODE_ENV=development

# =============================================================================
# Rate Limiting Configuration
# =============================================================================

# Maximum requests per time window per project (default: 100)
# Set higher for high-volume projects, lower for tighter control
RATE_LIMIT_MAX=100

# Time window in milliseconds (default: 60000 = 1 minute)
# Requests are counted within this sliding window
RATE_LIMIT_WINDOW_MS=60000

# =============================================================================
# OpenTelemetry / Observability (Optional)
# =============================================================================
# When OTEL_EXPORTER_OTLP_ENDPOINT is set, traces, metrics and logs are 
# sent to the OTLP endpoint. See docs/observability.md for details.
#
# Example configurations:
#
# Local development (collector on same host):
#   OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4318
#   OTEL_EXPORTER_OTLP_INSECURE=true
#
# Docker Desktop (collector on host):
#   OTEL_EXPORTER_OTLP_ENDPOINT=http://host.docker.internal:4318
#   OTEL_EXPORTER_OTLP_INSECURE=true
#
# Docker Compose (collector as service):
#   OTEL_EXPORTER_OTLP_ENDPOINT=http://otel-collector:4318
#   OTEL_EXPORTER_OTLP_INSECURE=true

# Service name for traces (default: maritaca-api or maritaca-worker)
# OTEL_SERVICE_NAME=maritaca-api

# OTLP endpoint for traces and metrics (enables observability when set)
# OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4318

# OTLP endpoint specifically for logs (optional, derived from above if not set)
# OTEL_EXPORTER_OTLP_LOGS_ENDPOINT=http://localhost:4318/v1/logs

# Allow insecure (non-TLS) connections to OTLP endpoint (default: false)
# Set to true for local development without TLS
# OTEL_EXPORTER_OTLP_INSECURE=true

# =============================================================================
# Email Provider Configuration
# =============================================================================

# Default email provider: mock, resend, or ses (default: mock)
# - mock: Logs emails instead of sending (for development/testing)
# - resend: Uses Resend API (requires RESEND_API_KEY)
# - ses: Uses AWS SES (requires AWS credentials)
EMAIL_PROVIDER=mock

# -----------------------------------------------------------------------------
# Resend Configuration (required when EMAIL_PROVIDER=resend)
# -----------------------------------------------------------------------------
# Get your API key from: https://resend.com/api-keys
# RESEND_API_KEY=re_xxxxxxxxxx

# -----------------------------------------------------------------------------
# AWS SES Configuration (required when EMAIL_PROVIDER=ses)
# -----------------------------------------------------------------------------
# AWS credentials can be provided via:
# 1. These environment variables
# 2. IAM role (when running on AWS EC2/ECS/Lambda)
# 3. AWS credentials file (~/.aws/credentials)

# AWS Access Key ID (optional if using IAM role)
# AWS_ACCESS_KEY_ID=AKIAXXXXXXXXXXXXXXXX

# AWS Secret Access Key (optional if using IAM role)
# AWS_SECRET_ACCESS_KEY=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# AWS Region for SES (required for SES)
# Common regions: us-east-1, us-west-2, eu-west-1
# AWS_REGION=us-east-1

# Alternative: AWS_DEFAULT_REGION (used if AWS_REGION is not set)
# AWS_DEFAULT_REGION=us-east-1

# =============================================================================
# Slack Provider Configuration
# =============================================================================

# Slack Bot Token (REQUIRED for Slack channel)
# Must be configured via environment variable for security reasons
# Get your token from: https://api.slack.com/apps
# Required scopes: chat:write, users:read.email (for email lookup)
SLACK_BOT_TOKEN=xoxb-your-slack-bot-token-here

# =============================================================================
# Audit Log Configuration (GDPR/LGPD Compliance)
# =============================================================================
# Audit logs store a complete trail of all notifications sent,
# with PII encrypted for compliance with data protection regulations.

# Encryption key for PII data in audit logs (REQUIRED for production)
# Generate with: openssl rand -base64 32
# CRITICAL: Store securely and backup! Loss of key = loss of audit PII data
# AUDIT_ENCRYPTION_KEY=your-base64-encoded-32-byte-key

# Whether to hash subject IDs in audit logs for additional privacy (default: true)
# When true: subject IDs are SHA-256 hashed before storage
# When false: subject IDs are stored as-is (needed for exact match queries)
# AUDIT_HASH_SUBJECT_IDS=true

# Audit log partition retention in months (default: 12)
# Partitions older than this will be automatically dropped by maintenance job
# Adjust based on your compliance requirements (GDPR: typically 6-24 months)
# AUDIT_RETENTION_MONTHS=12

# Number of months ahead to create partitions (default: 3)
# Ensures partitions exist before data arrives
# AUDIT_PARTITION_MONTHS_AHEAD=3

# Cron pattern for partition maintenance job (default: daily at 3 AM)
# Uses standard cron syntax: minute hour day-of-month month day-of-week
# Examples:
#   0 3 * * *     = Every day at 3:00 AM
#   0 0 * * 0     = Every Sunday at midnight
#   0 */6 * * *   = Every 6 hours
# AUDIT_MAINTENANCE_CRON=0 3 * * *
